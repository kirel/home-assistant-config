- id: Rolladen wochentags bei Sonnenaufgang hoch
  alias: Rolladen wochentags bei Sonnenaufgang hoch
  description: ''
  trigger:
  - platform: time
    at: '7:00'
  condition:
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
  action:
  - device_id: 86fcff9ca4efa7527e7df555b4df40f8
    domain: cover
    entity_id: cover.shelly_bad
    type: set_position
    position: 100
  mode: single
- id: Rolladen am Wochenende morgens hoch
  alias: Rolladen am Wochenende morgens hoch
  description: ''
  trigger:
  - platform: time
    at: 09:00:00
  condition:
  - condition: time
    weekday:
    - sat
    - sun
  action:
  - device_id: 86fcff9ca4efa7527e7df555b4df40f8
    domain: cover
    entity_id: cover.shelly_bad
    type: set_position
    position: 100
  mode: single
- id: Rolladen bei Sonnenuntergang runter
  alias: Rolladen bei Sonnenuntergang runter
  description: ''
  trigger:
  - platform: sun
    event: sunset
  action:
  - device_id: 86fcff9ca4efa7527e7df555b4df40f8
    domain: cover
    entity_id: cover.shelly_bad
    type: set_position
    position: 0
  mode: single
- id: '1610697818461'
  alias: Luftfeuchtigkeit
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.shelly_h_t_2e4009_humidity
    above: '60'
  - platform: numeric_state
    entity_id: sensor.netatmo_wohnung_buro_schlafzimmer_humidity
    above: '60'
  - platform: numeric_state
    entity_id: sensor.netatmo_wohnung_buro_humidity
    above: '60'
  condition: []
  action:
  - service: notify.mobile_app_mobilgeraet
    data:
      message: Die Luftfeuchtigkeit ist über 60%. Lüften wäre angebracht.
      data:
        url: /lovelace-dash/klima
  mode: single
- id: '1625467803796'
  alias: Sonnenaufgang
  description: ''
  trigger:
  - platform: sun
    event: sunrise
  condition: []
  action:
  - device_id: 98c5db78406a0c80d54be114f1926a94
    domain: cover
    entity_id: cover.wohnzimmer_rollo
    type: set_position
    position: 100
  - device_id: 86fcff9ca4efa7527e7df555b4df40f8
    domain: cover
    entity_id: cover.shelly_bad
    type: set_position
    position: 100
  - device_id: b1160333c0563a465802613977d873a5
    domain: cover
    entity_id: cover.kuche_rollo_links
    type: set_position
    position: 100
  - device_id: c373d68cdf1b59f6d679a8006a8f1ee8
    domain: cover
    entity_id: cover.kuche_rollo_rechts
    type: set_position
    position: 100
  - device_id: 16cd2d1b13ad782383b99b622c485aac
    domain: cover
    entity_id: cover.wohnzimmer_rollo_balkon_links
    type: set_position
    position: 100
  - device_id: ab8caa70466a3518904275bfeaa44606
    domain: cover
    entity_id: cover.wohnzimmer_rollo_balkon_rechts
    type: set_position
    position: 100
  - device_id: 47f565dff4d81fb6a7a092460f685ce1
    domain: cover
    entity_id: cover.schlafzimmer_rollo_links
    type: set_position
    position: 100
  - device_id: 12eb92e3c31383da36745eebc66f6b57
    domain: cover
    entity_id: cover.schlafzimmer_rollo_rechts
    type: set_position
    position: 100
  mode: single
- id: '1625468117983'
  alias: Sonnenuntergang
  description: ''
  trigger:
  - platform: sun
    event: sunset
  condition: []
  action:
  - device_id: 98c5db78406a0c80d54be114f1926a94
    domain: cover
    entity_id: cover.wohnzimmer_rollo
    type: set_position
    position: 0
  - device_id: 86fcff9ca4efa7527e7df555b4df40f8
    domain: cover
    entity_id: cover.shelly_bad
    type: set_position
    position: 0
  - device_id: b1160333c0563a465802613977d873a5
    domain: cover
    entity_id: cover.kuche_rollo_links
    type: set_position
    position: 0
  - device_id: c373d68cdf1b59f6d679a8006a8f1ee8
    domain: cover
    entity_id: cover.kuche_rollo_rechts
    type: set_position
    position: 0
  - device_id: 16cd2d1b13ad782383b99b622c485aac
    domain: cover
    entity_id: cover.wohnzimmer_rollo_balkon_links
    type: set_position
    position: 0
  - device_id: ab8caa70466a3518904275bfeaa44606
    domain: cover
    entity_id: cover.wohnzimmer_rollo_balkon_rechts
    type: set_position
    position: 0
  - device_id: 47f565dff4d81fb6a7a092460f685ce1
    domain: cover
    entity_id: cover.schlafzimmer_rollo_links
    type: set_position
    position: 0
  - device_id: 12eb92e3c31383da36745eebc66f6b57
    domain: cover
    entity_id: cover.schlafzimmer_rollo_rechts
    type: set_position
    position: 0
  mode: single
- id: wake_up_raw_s1
  alias: Wake up RAW S1
  trigger:
  - platform: event
    event_type: ifttt_webhook_received
    event_data:
      action: wake_up_raw_s1
  condition: []
  action:
  - service: switch.turn_on
    target:
      entity_id: switch.raw_s1
  mode: single
- id: hibernate_raw_s1
  alias: Hibernate RAW S1
  trigger:
  - platform: event
    event_type: ifttt_webhook_received
    event_data:
      action: hibernate_raw_s1
  condition: []
  action:
  - service: switch.turn_off
    target:
      entity_id: switch.raw_s1
  mode: single
- id: '1637325203606'
  alias: Kräuterlicht morgens an (Wochentag)
  description: ''
  trigger:
  - platform: time
    at: 09:00
  condition:
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
  action:
  - type: turn_on
    device_id: 854ad8f5550d1f2c6ec354bd9fbf879d
    entity_id: light.light_3
    domain: light
  mode: single
- id: '1637325456949'
  alias: Kräuterlicht abends aus
  description: ''
  trigger:
  - platform: time
    at: '20:00'
  condition: []
  action:
  - type: turn_off
    device_id: 854ad8f5550d1f2c6ec354bd9fbf879d
    entity_id: light.light_3
    domain: light
  mode: single
- id: '1643434481496'
  alias: Licher aus wenn nicht zuhause
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: zone.home
    for:
      hours: 0
      minutes: 5
      seconds: 0
    below: '1'
  condition: []
  action:
  - service: script.alle_lichter_aus
    data: {}
  - service: notify.mobile_app_mobilgeraet
    data:
      message: Alle Lichter ausgeschaltet.
  mode: single
- id: '1643638551817'
  alias: Kräuterlicht morgens an (Wochenende)
  description: ''
  trigger:
  - platform: time
    at: '10:00'
  condition:
  - condition: time
    weekday:
    - sat
    - sun
  action:
  - type: turn_on
    device_id: 854ad8f5550d1f2c6ec354bd9fbf879d
    entity_id: light.light_3
    domain: light
  mode: single
- id: '1643811163188'
  alias: Klimaalarm Büro
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.co2_alarm_buro
    to: 'on'
  - type: motion
    platform: device
    device_id: 352ad6bf32b06065348bea8b8cb50cac
    entity_id: binary_sensor.hue_motion_sensor_1_motion
    domain: binary_sensor
  condition:
  - condition: time
    before: '20:00:00'
    after: 07:00:00
  - type: is_motion
    condition: device
    device_id: 352ad6bf32b06065348bea8b8cb50cac
    entity_id: binary_sensor.hue_motion_sensor_1_motion
    domain: binary_sensor
  - condition: state
    entity_id: binary_sensor.co2_alarm_buro
    state: 'on'
  action:
  - type: turn_on
    device_id: 356ebc7983e637c821be0a87dc402fe4
    entity_id: light.hue_filament_bulb_1
    domain: light
    brightness_pct: 1
  - service: persistent_notification.create
    data:
      notification_id: office_co2
      message: "\U0001F32C Bitte im Büro lüften."
  - if:
    - condition: state
      entity_id: media_player.buro
      state: 'off'
    then:
    - service: script.klimacheck_buro
      data: {}
  mode: single
- id: '1643811985877'
  alias: Klimaalarm Büro vorbei
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.co2_alarm_buro
    to: 'off'
  - type: no_motion
    platform: device
    device_id: 352ad6bf32b06065348bea8b8cb50cac
    entity_id: binary_sensor.hue_motion_sensor_1_motion
    domain: binary_sensor
    for:
      hours: 0
      minutes: 5
      seconds: 0
  condition: []
  action:
  - type: turn_off
    device_id: 356ebc7983e637c821be0a87dc402fe4
    entity_id: light.hue_filament_bulb_1
    domain: light
  - service: persistent_notification.dismiss
    data:
      notification_id: office_co2
  mode: single
- id: '1644165727122'
  alias: 'Waschmaschine: fertig'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.waschmaschine_lauft
    from: 'on'
    to: 'off'
  condition: []
  action:
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.washing_machine_done
  - service: notify.notify
    data:
      message: Die Waschmaschine ist fertig.
      data:
        url: /lovelace-dash/haushalt
        tag: washing_machine_done
  - service: persistent_notification.create
    data:
      message: "\U0001F9FA Die Waschmaschine kann ausgeräumt werden."
      notification_id: washing_machine_done
  - service: persistent_notification.dismiss
    data:
      notification_id: washing_machine_running
  mode: single
- id: '1644477747022'
  alias: Badtür auf
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 9a0a2e676c9e1f01459e7c5d0e14eec8
    entity_id: binary_sensor.bad_balkontuer
    domain: binary_sensor
    for:
      hours: 0
      minutes: 15
      seconds: 0
  condition:
  - condition: numeric_state
    entity_id: sensor.netatmo_wohnung_weather_station_draussen_temperature
    below: '18'
  action:
  - service: persistent_notification.create
    data:
      notification_id: bathroom_door
      message: "\U0001FA9F Badtür ist noch offen."
  - service: notify.mobile_app_mobilgeraet
    data:
      message: Badtür ist noch offen.
      data:
        tag: bathroomdoor_open
  - service: tts.google_translate_say
    data:
      entity_id: media_player.badezimmer
      message: Die Tür im Bad ist seit 15 Minuten offen.
      language: de
  mode: single
- id: '1644477787474'
  alias: Badtür zu
  description: ''
  trigger:
  - type: not_opened
    platform: device
    device_id: 9a0a2e676c9e1f01459e7c5d0e14eec8
    entity_id: binary_sensor.bad_balkontuer
    domain: binary_sensor
  condition: []
  action:
  - service: persistent_notification.dismiss
    data:
      notification_id: bathroom_door
  - service: notify.mobile_app_mobilgeraet
    data:
      message: clear_notification
      data:
        tag: bathroomdoor_open
  mode: single
- id: '1644593133663'
  alias: Küchenschublade macht das Licht an
  description: ''
  trigger:
  - type: vibration
    platform: device
    device_id: 5f176d84b7d9ebdc13f7968e468d5464
    entity_id: binary_sensor.vibrationssensor_vibration
    domain: binary_sensor
  condition: []
  action:
  - type: turn_on
    device_id: bdff3fc346f291b6f341547859f8cce1
    entity_id: light.on_off_plug_1_2
    domain: light
  mode: single
- id: shellies_announce
  alias: Shellies Announce
  trigger:
  - platform: homeassistant
    event: start
  - platform: time_pattern
    hours: /1
  action:
    service: mqtt.publish
    data:
      topic: shellies/command
      payload: announce
- id: shellies_discovery
  alias: Shellies Discovery
  mode: queued
  max: 999
  trigger:
    platform: mqtt
    topic: shellies/announce
  action:
    service: python_script.shellies_discovery
    data:
      id: '{{ trigger.payload_json.id }}'
      mac: '{{ trigger.payload_json.mac }}'
      fw_ver: '{{ trigger.payload_json.fw_ver }}'
      model: '{{ trigger.payload_json.model }}'
      mode: '{{ trigger.payload_json.mode | default }}'
      host: '{{ trigger.payload_json.ip }}'
- id: '1644877994194'
  alias: Mikrowelle morgens an
  description: ''
  trigger:
  - platform: time
    at: '10:00'
  condition:
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
    - sun
  action:
  - type: turn_on
    device_id: 034b90190b49113fed548142e7537fcc
    entity_id: switch.mikrowelle
    domain: switch
  mode: single
- id: '1644878066858'
  alias: Mikrowelle abends aus
  description: ''
  trigger:
  - platform: time
    at: '23:00'
  condition:
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
    - sun
  action:
  - type: turn_off
    device_id: 034b90190b49113fed548142e7537fcc
    entity_id: switch.mikrowelle
    domain: switch
  mode: single
- id: '1646639581197'
  alias: 'Arbeit: Meeting Szene wenn Kamera in Benutzung'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.daniels_billie_macbook_pro_camera_in_use
    to: 'on'
  condition: []
  action:
  - service: scene.turn_on
    data: {}
    target:
      entity_id: scene.meeting
  mode: single
- id: '1646640422554'
  alias: Feierabend
  description: ''
  trigger:
  - platform: state
    entity_id: timer.office_occupied
    to: idle
  condition: []
  action:
  - service: script.feierabend
    data: {}
  mode: single
- id: '1646825875759'
  alias: Daniel BLE tracking
  description: Set a device tracker based on Daniels iPhone and Venu 2
  trigger:
  - platform: homeassistant
    event: start
  - platform: state
    entity_id: sensor.daniel_ble
  condition: []
  action:
  - service: device_tracker.see
    data_template:
      dev_id: daniel_ble
      location_name: "{% if is_state('sensor.daniel_ble', 'not_home') -%}\n  not_home\n{%-
        else -%}\n  home\n{%- endif %}\n"
  mode: single
- id: '1646852885688'
  alias: 'Arbeit: Auf Arbeit'
  description: ''
  trigger:
  - platform: state
    entity_id: device_tracker.daniel_ble
    to: office
  - type: motion
    platform: device
    device_id: 352ad6bf32b06065348bea8b8cb50cac
    entity_id: binary_sensor.hue_motion_sensor_1_motion
    domain: binary_sensor
  condition: []
  action:
  - service: timer.start
    data: {}
    target:
      entity_id: timer.office_occupied
  mode: single
- id: '1647703831198'
  alias: Wärmelampe timer starten
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: 5021d5f39bca4bd5277fb35408a7b63c
    entity_id: light.wickeltisch
    domain: light
  - platform: device
    type: turned_on
    device_id: b2f6c6e8419ebaeff38b39d11000ab8e
    entity_id: switch.warmelampe
    domain: switch
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: input_boolean.warmelampe_langer
        state: 'on'
      sequence:
      - service: timer.start
        data:
          duration: '1:00:00'
        target:
          entity_id: timer.warmelampe
      - service: input_boolean.turn_off
        data: {}
        target:
          entity_id: input_boolean.warmelampe_langer
    default:
    - service: timer.start
      data:
        duration: 00:15:00
      target:
        entity_id: timer.warmelampe
  mode: single
- id: '1647704077677'
  alias: Wärmelampe timer beendet
  description: ''
  trigger:
  - platform: event
    event_type: timer.finished
    event_data:
      entity_id: timer.warmelampe
  condition: []
  action:
  - service: script.wickeln_fertig
    data: {}
  mode: single
- id: '1647704443606'
  alias: Wärmelampe timer verlängern
  description: ''
  trigger:
  - platform: state
    entity_id: input_boolean.warmelampe_langer
    to: 'on'
  condition: []
  action:
  - service: timer.start
    data:
      duration: '1:00:00'
    target:
      entity_id: timer.warmelampe
  - type: turn_on
    device_id: b2f6c6e8419ebaeff38b39d11000ab8e
    entity_id: switch.warmelampe
    domain: switch
  mode: single
- id: '1647898463182'
  alias: 'Arbeit: Arbeitsbeleuchtung aus wenn Monitor aus'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.monitor_in_use
    to: 'off'
    for:
      hours: 0
      minutes: 5
      seconds: 0
  condition: []
  action:
  - service: light.turn_off
    data: {}
    target:
      entity_id:
      - light.schreibtisch_daniel_2
      - light.daniel_schreibtisch_mitte
  mode: single
- id: '1648062274112'
  alias: Wärmelampe manuell aus
  description: ''
  trigger:
  - platform: device
    type: turned_off
    device_id: b2f6c6e8419ebaeff38b39d11000ab8e
    entity_id: switch.warmelampe
    domain: switch
  condition: []
  action:
  - service: timer.cancel
    data: {}
    target:
      entity_id: timer.warmelampe
  mode: single
- id: '1648655693183'
  alias: 'Saugen: D9 fährt'
  description: ''
  trigger:
  - platform: state
    entity_id: vacuum.dreame_d9
    to: cleaning
  condition: []
  action:
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.vacuum_emptied
  mode: single
- id: '1648665239768'
  alias: 'Saugen: D9 leeren'
  description: ''
  trigger:
  - platform: state
    entity_id: vacuum.dreame_d9
    from: cleaning
  condition:
  - condition: state
    entity_id: binary_sensor.vacuum_needs_emptying
    state: 'on'
  action:
  - service: notify.mobile_app_mobilgeraet
    data:
      message: D9 leeren.
      data:
        url: /lovelace-dash/haushalt
        actions:
        - action: EMPTIED
          title: Geleert
          uri: shortcuts://run-shortcut?name=D9%20geleert
  - service: persistent_notification.create
    data:
      notification_id: d9_needs_emptying
      message: "\U0001F9F9 D9 muss geleert werden."
  mode: single
- id: '1648668046071'
  alias: 'Saugen: D9 geleert'
  description: ''
  trigger:
  - platform: state
    entity_id: input_boolean.vacuum_emptied
    to: 'on'
  condition: []
  action:
  - service: input_datetime.set_datetime
    data:
      datetime: '{{ now() }}'
    target:
      entity_id: input_datetime.d9_last_emptied
  - service: persistent_notification.dismiss
    data:
      notification_id: d9_needs_emptying
  mode: single
- id: '1649019308494'
  alias: 'Waschmaschine: ausgeräumt'
  description: ''
  trigger:
  - platform: state
    entity_id: input_boolean.washing_machine_done
    from: 'on'
    to: 'off'
  condition: []
  action:
  - service: notify.mobile_app_mobilgeraet
    data:
      message: clear_notification
      data:
        tag: washing_machine_done
  - service: persistent_notification.dismiss
    data:
      notification_id: washing_machine_done
  mode: single
- id: '1649020261386'
  alias: 'Waschmaschine: automatisch ausgeräumt'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.daniel_ble
    to: washroom
    for:
      hours: 0
      minutes: 1
      seconds: 0
  - platform: state
    entity_id: binary_sensor.waschmaschine_lauft
    to: 'on'
  - type: opened
    platform: device
    device_id: 413be4282abb9a125d333ecd510f7db5
    entity_id: binary_sensor.tur_waschmaschine
    domain: binary_sensor
  condition: []
  action:
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.washing_machine_done
  mode: single
- id: '1649189556776'
  alias: Wickeln tracking
  description: ''
  trigger:
  - platform: device
    type: turned_off
    device_id: 5021d5f39bca4bd5277fb35408a7b63c
    entity_id: light.wickeltisch
    domain: light
  condition: []
  action:
  - service: notify.mobile_app_mobilgeraet
    data:
      message: Groß oder klein? {{ now().strftime('%H:%M') }}
      data:
        url: shortcuts://run-shortcut?name=Baby%20Tracker
        actions:
        - action: CLEAN
          title: Sauber
          uri: shortcuts://run-shortcut?name=Trockene%20Windel
        - action: WET
          title: Nass
          uri: shortcuts://run-shortcut?name=Nasse%20Windel
        - action: DIRTY
          title: Dreckig
          uri: shortcuts://run-shortcut?name=Schmutzige%20Windel
        - action: MIXED
          title: Gemischt
          uri: shortcuts://run-shortcut?name=Gemischte%20Windel
  mode: single
- id: '1650216316961'
  alias: Klimalicht Schlafzimmer
  description: 'Wenn der Plug an geht, mach Kommode an mit einem Lichtton, der den
    Co2-Sensor widerspiegelt.

    Wenn der Plug ausgeht mach das Klimalicht wieder aus.'
  trigger:
  - platform: device
    type: changed_states
    device_id: 334e8d965b2ce08a09bd2597ae9deca9
    entity_id: light.on_off_plug_1
    domain: light
  condition: []
  action:
  - choose:
    - conditions:
      - condition: device
        type: is_off
        device_id: 334e8d965b2ce08a09bd2597ae9deca9
        entity_id: light.on_off_plug_1
        domain: light
      sequence:
      - type: turn_off
        device_id: 23463e1aa3532dbb05776cd18c12d83f
        entity_id: light.schlafzimmer_kommode
        domain: light
    - conditions:
      - condition: device
        type: is_on
        device_id: 334e8d965b2ce08a09bd2597ae9deca9
        entity_id: light.on_off_plug_1
        domain: light
      sequence:
      - service: light.turn_on
        data:
          brightness: 2
          hs_color:
          - "{% set co2 = states('sensor.netatmo_wohnung_weather_station_schlafzimmer_co2')
            %} {% if co2 == 'unavailable' %}\n  360\n{% elif co2 | float < 400 %}\n
            \ 120\n{% elif co2 | float < 2000 %}\n  {{ ((co2 | float - 400) * -0.075)
            | round(0) | int + 120 }}\n{% else %}\n  1\n{% endif %}\n"
          - 100
        target:
          entity_id: light.schlafzimmer_kommode
    default: []
  mode: single
- id: '1650702539465'
  alias: Handle Tag Scan
  trigger:
  - platform: event
    event_type: tag_scanned
  condition:
  - condition: template
    value_template: '{{ trigger.event.data.tag_id in tags }}'
  action:
  - variables:
      media_player_entity_id: media_player.buro
      media_content_id: '{{ tags[trigger.event.data.tag_id].media_content_id }}'
      media_content_type: '{{ tags[trigger.event.data.tag_id].media_content_type }}'
  - service: media_player.play_media
    target:
      entity_id: '{{ media_player_entity_id }}'
    data:
      media_content_id: '{{ media_content_id }}'
      media_content_type: '{{ media_content_type }}'
  - delay: 2
  mode: single
  max_exceeded: silent
  variables:
    media_players:
      0e19cd3cf2b311ea88f469a7512c307d: media_player.buro
    tags:
      0006274008:
        media_content_id: spotify:track:5qBRuc4kh5IjTzIuMfoIJ8
        media_content_type: spotify://track
- id: '1651698525761'
  alias: Klimaalarm Schlafzimmer
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.co2_alarm_schlafzimmer
    to: 'on'
    id: co2_alarm_on
  - platform: state
    entity_id:
    - binary_sensor.co2_alarm_schlafzimmer
    to: 'off'
    id: co2_alarm_off
  condition: []
  action:
  - if:
    - condition: trigger
      id: co2_alarm_on
    then:
    - service: persistent_notification.create
      data:
        notification_id: co2_alarm_bedroom
        message: "\U0001F32C Bitte im Schlafzimmer lüften."
    else:
    - service: persistent_notification.dismiss
      data:
        notification_id: co2_alarm_bedroom
  mode: single
- id: '1651732579702'
  alias: Leaf Batteriewarnung
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.leaf_batterie_niedrig
    to: 'on'
    id: leaf_battery_low
  - platform: state
    entity_id:
    - binary_sensor.leaf_batterie_niedrig
    to: 'off'
  condition: []
  action:
  - if:
    - condition: trigger
      id: leaf_battery_low
    then:
    - service: persistent_notification.create
      data:
        notification_id: leaf_battery_low
        message: "\U0001FAAB Bitte Leaf laden."
    else:
    - service: persistent_notification.dismiss
      data:
        notification_id: leaf_battery_low
  mode: single
- id: '1652732792541'
  alias: 'Rollos: Wohnung verrammeln Benachrichtigung'
  description: 'Wenn es über 25 Grad wird und der Forecast sunny oder partlycloudy
    ist: Persistent Notification zum Wohnung verrammeln

    Wenn die Rollos <51% sind oder es nach 18 Uhr ist wird sie dismissed. '
  trigger:
  - platform: numeric_state
    entity_id: sensor.openweathermap_forecast_temperature
    above: '25'
  - platform: state
    entity_id:
    - sensor.openweathermap_forecast_condition
    to: sunny
  - platform: state
    entity_id:
    - sensor.openweathermap_forecast_condition
    to: partlycloudy
  - platform: sun
    event: sunrise
    offset: 0
  condition:
  - condition: numeric_state
    entity_id: sensor.openweathermap_forecast_temperature
    above: '25'
  - condition: or
    conditions:
    - condition: state
      entity_id: sensor.openweathermap_forecast_condition
      state: sunny
    - condition: state
      entity_id: sensor.openweathermap_forecast_condition
      state: partlycloudy
  - condition: sun
    before: sunset
    after: sunrise
    before_offset: '-1:00:00'
  - condition: numeric_state
    entity_id: cover.fenster_zum_verrammeln
    attribute: current_position
    above: '70'
  action:
  - service: persistent_notification.create
    data:
      notification_id: verrammeln
      message: ☀️ Es wird warm. Wohnung verrammeln?
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.wohnung_verrammeln_anbieten
  mode: single
- id: '1653028213005'
  alias: Octopi Bild wenn fertig
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.octoprint_print_progress
    above: '99.99'
  - platform: numeric_state
    entity_id: sensor.octoprint_print_progress
    above: '49.99'
  condition: []
  action:
  - service: script.octocast
    data: {}
  - type: turn_on
    device_id: 8b90320cb352ec3bdb8b1ff8125606f5
    entity_id: switch.druckerlicht
    domain: switch
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - service: notify.mobile_app_mobilgeraet
    data:
      message: Drucker ist {{states('sensor.octoprint_print_progress')|int}}% fertig.
      data:
        entity_id: camera.octoprint
        url: /lovelace-prusa/0
  - delay:
      hours: 0
      minutes: 5
      seconds: 0
      milliseconds: 0
  - type: turn_off
    device_id: 8b90320cb352ec3bdb8b1ff8125606f5
    entity_id: switch.druckerlicht
    domain: switch
  mode: single
- id: '1653119725559'
  alias: Wickelecke Button
  description: ''
  trigger:
  - device_id: d729cd0da25b170f6d49882df1e490e4
    domain: hue
    platform: device
    type: short_release
    subtype: 1
    unique_id: dff80a24-ec3f-4c0d-a870-4ed6e8cc6e89
    id: wickelecke_button_kurz
  - device_id: d729cd0da25b170f6d49882df1e490e4
    domain: hue
    platform: device
    type: repeat
    subtype: 1
    unique_id: dff80a24-ec3f-4c0d-a870-4ed6e8cc6e89
    id: wickelecke_button_lang
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: wickelecke_button_kurz
      sequence:
      - choose:
        - conditions:
          - condition: device
            type: is_off
            device_id: 5021d5f39bca4bd5277fb35408a7b63c
            entity_id: light.wickeltisch
            domain: light
          sequence:
          - service: script.wickeln
            data: {}
        default:
        - service: script.wickeln_fertig
          data: {}
    - conditions:
      - condition: trigger
        id: wickelecke_button_lang
      sequence:
      - service: script.wickeln_fertig
        data: {}
      - service: scene.turn_on
        target:
          entity_id: scene.stillen
    default: []
  mode: single
- id: '1653478934255'
  alias: Play Music tag
  description: ''
  use_blueprint:
    path: luka6000/PlayMusicTag.yaml
    input:
      reader_id: 480a00c603cd897ec288e1c39cd684d9
      player: media_player.buro
- id: '1653691012147'
  alias: Rollos nach Sonnenstand
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.sonne_trifft_sudfenster
    - binary_sensor.sonne_trifft_westfenster
    - binary_sensor.sonne_trifft_schlafzimmerfenster
  - platform: numeric_state
    entity_id: sensor.openweathermap_cloud_coverage
    below: input_number.rollos_nach_sonnenstand_bedeckungsgrad
  - platform: numeric_state
    entity_id: sensor.openweathermap_temperature
    above: input_number.rollos_nach_sonnenstand_temperatur
  - platform: state
    entity_id:
    - input_boolean.rollos_nach_sonnenstand
  - platform: time
    at: '11:00:00'
  condition:
  - condition: state
    entity_id: input_boolean.rollos_nach_sonnenstand
    state: 'on'
  - condition: state
    entity_id: input_boolean.schlafmodus
    state: 'off'
  - condition: sun
    after: sunrise
    before: sunset
  - condition: time
    after: '10:00:00'
    before: '19:00:00'
  action:
  - if:
    - condition: state
      entity_id: binary_sensor.sonne_trifft_schlafzimmerfenster
      state: 'on'
    - condition: numeric_state
      entity_id: sensor.openweathermap_cloud_coverage
      below: input_number.rollos_nach_sonnenstand_bedeckungsgrad
    - condition: numeric_state
      entity_id: sensor.openweathermap_temperature
      above: input_number.rollos_nach_sonnenstand_temperatur
    then:
    - device_id: d4fe64964b90b59d38287dd07b740305
      domain: cover
      entity_id: cover.schlafzimmer_rollo_balkon
      type: set_position
      position: 50
    else:
    - device_id: d4fe64964b90b59d38287dd07b740305
      domain: cover
      entity_id: cover.schlafzimmer_rollo_balkon
      type: set_position
      position: 100
  - if:
    - condition: state
      entity_id: binary_sensor.sonne_trifft_sudfenster
      state: 'on'
    - condition: numeric_state
      entity_id: sensor.openweathermap_cloud_coverage
      below: input_number.rollos_nach_sonnenstand_bedeckungsgrad
    - condition: numeric_state
      entity_id: sensor.openweathermap_temperature
      above: input_number.rollos_nach_sonnenstand_temperatur
    then:
    - service: cover.set_cover_position
      data:
        position: 50
      target:
        entity_id: cover.fenster_suden
    else:
    - service: cover.set_cover_position
      data:
        position: 100
      target:
        entity_id: cover.fenster_suden
  - if:
    - condition: state
      entity_id: binary_sensor.sonne_trifft_westfenster
      state: 'on'
    - condition: numeric_state
      entity_id: sensor.openweathermap_cloud_coverage
      below: input_number.rollos_nach_sonnenstand_bedeckungsgrad
    - condition: numeric_state
      entity_id: sensor.openweathermap_temperature
      above: input_number.rollos_nach_sonnenstand_temperatur
    then:
    - service: cover.set_cover_position
      data:
        position: 50
      target:
        entity_id: cover.fenster_westen
    else:
    - service: cover.set_cover_position
      data:
        position: 100
      target:
        entity_id: cover.fenster_westen
  mode: restart
- id: '1653859948513'
  alias: Meeting-Licht bei Event mit Meeting
  description: ''
  trigger:
  - platform: calendar
    event: start
    entity_id: calendar.daniel_sabine
  condition:
  - condition: template
    value_template: '{{ "zoom" in trigger.calendar_event.location }}'
  action:
  - service: notify.mobile_app_mobilgeraet
    data:
      message: '{{trigger.calendar_event.summary}}'
  mode: single
- id: '1653912757058'
  alias: 'Lüften: Rollo auf Lüften wenn geöffnet'
  description: Schließt das Rollo nicht ganz wenn das Fenster offen ist und öffnet
    es leicht wenn das Fenster geöffnet wird.
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.wohnzimmer_balkontursensor_links_contact
    - binary_sensor.wohnzimmer_fenstersensor_contact
    - binary_sensor.bad_balkontursensor_contact
    - binary_sensor.kuche_fenstersensor_links_contact
    - binary_sensor.kuche_fenstersensor_rechts_contact
    - binary_sensor.buro_fenstersensor_contact
    - binary_sensor.buro_balkontursensor_contact
    - binary_sensor.schlafzimmer_balkontursensor_contact
    - binary_sensor.schlafzimmer_fenstersensor_links_contact
    - binary_sensor.schlafzimmer_fenstersensor_rechts_contact
    id: window
  - platform: state
    entity_id:
    - cover.wohnzimmer_rollo_balkon_links
    - cover.wohnzimmer_rollo
    - cover.shelly_bad
    - cover.kuche_rollo_links
    - cover.kuche_rollo_rechts
    - cover.buro_rollo
    - cover.buro_rollo_balkon
    - cover.schlafzimmer_rollo_balkon
    - cover.schlafzimmer_rollo_links
    - cover.schlafzimmer_rollo_rechts
    to: closed
    id: cover
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: window
      sequence:
      - if:
        - condition: template
          value_template: '{{ state_attr(mapping[trigger.entity_id], "current_position")
            <= posmapping[mapping[trigger.entity_id]] }}

            '
        then:
        - service: cover.set_cover_position
          data: '{ "position": {{ posmapping[mapping[trigger.entity_id]] if is_state(trigger.entity_id,
            ''on'') else 0 }} }

            '
          target:
            entity_id: '{{ mapping[trigger.entity_id] }}

              '
    - conditions:
      - condition: trigger
        id: cover
      sequence:
      - if:
        - condition: template
          value_template: '{{ is_state(mapping[trigger.entity_id], ''on'') }}

            '
        then:
        - service: cover.set_cover_position
          data: '{ "position": {{ posmapping[trigger.entity_id] }} }

            '
          target:
            entity_id: '{{ trigger.entity_id }}

              '
    default: []
  variables:
    mapping:
      binary_sensor.wohnzimmer_balkontursensor_links_contact: cover.wohnzimmer_rollo_balkon_links
      binary_sensor.wohnzimmer_fenstersensor_contact: cover.wohnzimmer_rollo
      binary_sensor.bad_balkontursensor_contact: cover.shelly_bad
      binary_sensor.kuche_fenstersensor_links_contact: cover.kuche_rollo_links
      binary_sensor.kuche_fenstersensor_rechts_contact: cover.kuche_rollo_rechts
      binary_sensor.buro_fenstersensor_contact: cover.buro_rollo
      binary_sensor.buro_balkontursensor_contact: cover.buro_rollo_balkon
      binary_sensor.schlafzimmer_balkontursensor_contact: cover.schlafzimmer_rollo_balkon
      binary_sensor.schlafzimmer_fenstersensor_links_contact: cover.schlafzimmer_rollo_links
      binary_sensor.schlafzimmer_fenstersensor_rechts_contact: cover.schlafzimmer_rollo_rechts
      cover.wohnzimmer_rollo_balkon_links: binary_sensor.wohnzimmer_balkontursensor_links_contact
      cover.wohnzimmer_rollo: binary_sensor.wohnzimmer_fenstersensor_contact
      cover.shelly_bad: binary_sensor.bad_balkontursensor_contact
      cover.kuche_rollo_links: binary_sensor.kuche_fenstersensor_links_contact
      cover.kuche_rollo_rechts: binary_sensor.kuche_fenstersensor_rechts_contact
      cover.buro_rollo: binary_sensor.buro_fenstersensor_contact
      cover.buro_rollo_balkon: binary_sensor.buro_balkontursensor_contact
      cover.schlafzimmer_rollo_balkon: binary_sensor.schlafzimmer_balkontursensor_contact
      cover.schlafzimmer_rollo_links: binary_sensor.schlafzimmer_fenstersensor_links_contact
      cover.schlafzimmer_rollo_rechts: binary_sensor.schlafzimmer_fenstersensor_rechts_contact
    posmapping:
      cover.wohnzimmer_rollo_balkon_links: 15
      cover.wohnzimmer_rollo: 15
      cover.shelly_bad: 15
      cover.kuche_rollo_links: 15
      cover.kuche_rollo_rechts: 15
      cover.buro_rollo: 15
      cover.buro_rollo_balkon: 15
      cover.schlafzimmer_rollo_balkon: 15
      cover.schlafzimmer_rollo_links: 15
      cover.schlafzimmer_rollo_rechts: 15
  mode: single
- id: '1654271432288'
  alias: Aqara Magic Cube (Z2M)
  description: ''
  use_blueprint:
    path: luckypoppy/z2m-xiaomi-cube-controller.yaml
    input:
      remote: sensor.wurfel_action
      shake:
      - service: script.feierabend
        data: {}
- id: '1654408376532'
  alias: Küche Plug bei Bewegung
  description: ''
  use_blueprint:
    path: freakshock88/motion_illuminance_activated_entity.yaml
    input:
      motion_sensor: binary_sensor.0x54ef44100043e010_occupancy
      target_entity: light.on_off_plug_1_2
      illuminance_sensor: sensor.0x54ef44100043e010_illuminance_lux
      no_motion_wait: input_number.bewegungsmelder_wartezeit
      illuminance_cutoff: input_number.bewegungsmelder_helligkeit
      time_limit_after: input_datetime.kuche_bewegungsmelder_ab_uhrzeit
      time_limit_before: input_datetime.kuche_bewegungsmelder_bis_uhrzeit
- id: '1654516254285'
  alias: Low battery level detection & notification for all battery sensors
  description: ''
  use_blueprint:
    path: sbyx/low-battery-level-detection-notification-for-all-battery-sensors.yaml
    input:
      exclude:
        entity_id:
        - sensor.daniels_ipad_2_battery_level
        - sensor.leaf_battery_level
        - sensor.mobilgeraet_battery_level
        - sensor.raw_battery_level
        - sensor.raw_battery_remaining
      threshold: 15
      time: '18:00:00'
      actions:
      - service: persistent_notification.create
        data:
          notification_id: low_battery_warning
          message: "\U0001FAAB bei: {{ sensors }}"
- id: '1654989864612'
  alias: Rollos manuell
  description: ''
  trigger:
  - platform: state
    entity_id:
    - cover.shelly_bad
    - cover.schlafzimmer_rollo_balkon
    - cover.schlafzimmer_rollo_links
    - cover.schlafzimmer_rollo_rechts
    - cover.buro_rollo
    - cover.buro_rollo_balkon
    - cover.kuche_rollo_rechts
    - cover.kuche_rollo_links
    - cover.wohnzimmer_rollo
    - cover.wohnzimmer_rollo_balkon_links
    - cover.wohnzimmer_rollo_balkon_rechts
    id: cover_moved
  - platform: event
    event_type: timer.finished
    id: timer_finished
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: cover_moved
      sequence:
      - service: input_boolean.turn_on
        target:
          entity_id: '{{trigger.entity_id | replace(''cover'', ''input_boolean'')
            ~ ''_manual''}}'
      - service: timer.start
        data:
          duration: '2:00:00'
        target:
          entity_id: '{{trigger.entity_id | replace(''cover'', ''timer'') ~ ''_manual''}}'
      - service: system_log.write
        data:
          level: error
          message: '{{this.context|to_json}}'
    - conditions:
      - condition: trigger
        id: timer_finished
      - condition: template
        value_template: '{{ states(trigger.event.data.entity_id | replace(''timer'',
          ''input_boolean'')) != ''unknown'' }}'
      sequence:
      - service: timer.cancel
        target:
          entity_id: '{{ trigger.event.data.entity_id | replace(''timer'', ''input_boolean'')
            }}'
      - service: input_boolean.turn_off
        target:
          entity_id: '{{trigger.event.data.entity_id | replace(''timer'', ''input_boolean'')
            }}'
    default: []
  mode: single
- id: '1655236362519'
  alias: 'Rollos: Wohnung verrammeln Benachrichtigung löschen'
  description: 'Wenn es über 25 Grad wird und der Forecast sunny oder partlycloudy
    ist: Persistent Notification zum Wohnung verrammeln

    Wenn die Rollos <51% sind oder es nach 18 Uhr ist wird sie dismissed. '
  trigger:
  - platform: numeric_state
    entity_id: cover.fenster_zum_verrammeln
    attribute: current_position
    below: '71'
  - platform: sun
    event: sunset
    offset: '-1:00:00'
  condition: []
  action:
  - service: persistent_notification.dismiss
    data:
      notification_id: verrammeln
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.wohnung_verrammeln_anbieten
  mode: single
- id: '1655363360652'
  alias: 'Arbeiten: Büro Rollo runter wenn es blendet'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.daniels_monitor_in_benutzung
    to: 'on'
  - platform: numeric_state
    entity_id: sun.sun
    above: '230'
    attribute: azimuth
  - platform: numeric_state
    entity_id: sun.sun
    attribute: elevation
    above: '10'
  condition:
  - condition: state
    entity_id: binary_sensor.daniels_monitor_in_benutzung
    state: 'on'
  - condition: numeric_state
    entity_id: sun.sun
    attribute: azimuth
    above: '220'
  - condition: numeric_state
    entity_id: sun.sun
    attribute: elevation
    above: '10'
  action:
  - service: scene.turn_on
    target:
      entity_id: scene.buro_rollo_arbeit
    metadata: {}
  mode: single
- id: '1657009430568'
  alias: 'Lüften im Sommer: wenn die Temperatur draußen unter die Temperatur drinnen
    sinkt'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.inside_warmer_than_outside
    to: 'on'
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition:
  - condition: numeric_state
    entity_id: sensor.wohnung_temperatur_mittelwert
    above: '24'
  - condition: state
    entity_id: binary_sensor.fenster_und_turen
    state: 'off'
  action:
  - service: persistent_notification.create
    data:
      notification_id: ventilate
      message: "\U0001F321 Draußen ist es jetzt kühler als drinnen. Jetzt lüften!
        \U0001F32C"
  - if:
    - condition: state
      entity_id: person.daniel_kirsch
      state: home
    then:
    - service: notify.mobile_app_mobilgeraet
      data:
        message: "\U0001F321 Draußen ist es jetzt kühler als drinnen. Jetzt lüften!
          \U0001F32C"
  mode: single
- id: '1657009645869'
  alias: 'Lüften im Sommer: Gelüftet'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.bad_balkontuer
    - binary_sensor.wohnzimmer_balkontuer
    - binary_sensor.buro_fenstersensor_contact
    - binary_sensor.kuche_fenstersensor_links_contact
    to: 'on'
    for:
      hours: 0
      minutes: 1
      seconds: 0
  - platform: state
    entity_id:
    - binary_sensor.inside_warmer_than_outside
    to: 'off'
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition: []
  action:
  - service: persistent_notification.dismiss
    data:
      notification_id: ventilate
  mode: single
- id: '1657009841315'
  alias: 'Lüften im Sommer: Fenster zu wenn die Temperatur draußen über die Temperatur
    drinnen steigt'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.inside_warmer_than_outside
    to: 'off'
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition:
  - condition: numeric_state
    entity_id: sensor.wohnung_temperatur_mittelwert
    above: '24'
  - condition: state
    entity_id: binary_sensor.fenster_und_turen
    state: 'on'
  action:
  - service: persistent_notification.create
    data:
      notification_id: stop_ventilate
      message: "\U0001F321 Draußen ist es jetzt wärmer als drinnen. Fenster zu! \U0001FA9F"
  - if:
    - condition: state
      entity_id: person.daniel_kirsch
      state: home
    then:
    - service: notify.mobile_app_mobilgeraet
      data:
        message: "\U0001F321 Draußen ist es jetzt wärmer als drinnen. Fenster zu!
          \U0001FA9F"
  mode: single
- id: '1657009912444'
  alias: 'Lüften im Sommer: Fenster geschlossen'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.fenster_und_turen
    to: 'off'
    for:
      hours: 0
      minutes: 1
      seconds: 0
  - platform: state
    entity_id:
    - binary_sensor.inside_warmer_than_outside
    to: 'on'
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition: []
  action:
  - service: persistent_notification.dismiss
    data:
      notification_id: stop_ventilate
  mode: single
- id: '1657286626072'
  alias: 'Arbeit: Meetinglich aus wenn Kamera aus'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.daniels_billie_macbook_pro_camera_in_use
    to: 'off'
  condition: []
  action:
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.daniel_schreibtisch_mitte
  mode: single
- id: '1658240820941'
  alias: 'Waschmaschine: läuft'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.waschmaschine_lauft
    to: 'on'
    from: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 0
  condition: []
  action:
  - service: persistent_notification.create
    data:
      message: "\U0001F9FC Die Waschmaschine läuft."
      notification_id: washing_machine_running
  - service: notify.mobile_app_mobilgeraet
    data:
      data:
        url: /lovelace-dash/haushalt
  mode: single
- id: '1658671139948'
  alias: 'Saugen: Beim Verlassen der Wohnung'
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: zone.home
    for:
      hours: 0
      minutes: 5
      seconds: 0
    below: '1'
  condition:
  - condition: state
    entity_id: input_boolean.spater_saugen
    state: 'on'
  action:
  - service: vacuum.start
    data: {}
    target:
      entity_id: vacuum.dreame_d9
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.spater_saugen
  mode: single
